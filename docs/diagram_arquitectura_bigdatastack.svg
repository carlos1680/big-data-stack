<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="1100" height="650" viewBox="0 0 1100 650" xmlns="http://www.w3.org/2000/svg">
  <style>
    .title { font: bold 22px sans-serif; }
    .subtitle { font: 16px sans-serif; }
    .box { fill: #f5f5f5; stroke: #333333; stroke-width: 1.5; }
    .box-strong { fill: #e0f7fa; stroke: #00796b; stroke-width: 1.8; }
    .box-db { fill: #fff3e0; stroke: #ef6c00; stroke-width: 1.8; }
    .box-proc { fill: #ede7f6; stroke: #5e35b1; stroke-width: 1.8; }
    .box-orch { fill: #e8f5e9; stroke: #2e7d32; stroke-width: 1.8; }
    .label { font: 13px sans-serif; }
    .small { font: 11px sans-serif; }
    .arrow { stroke: #555555; stroke-width: 1.4; marker-end: url(#arrowhead); fill: none; }
  </style>

  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7"
            refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#555555" />
    </marker>
  </defs>

  <!-- Título -->
  <text x="550" y="40" text-anchor="middle" class="title">
    Arquitectura general - BIGDATASTACK
  </text>
  <text x="550" y="65" text-anchor="middle" class="subtitle">
    Visión de alto nivel de servicios y flujos principales
  </text>

  <!-- Usuario -->
  <rect x="40" y="110" width="140" height="80" rx="10" ry="10" class="box-strong" />
  <text x="110" y="145" text-anchor="middle" class="label">Usuario</text>
  <text x="110" y="165" text-anchor="middle" class="small">Navegador web</text>

  <!-- Capa de acceso / UIs -->
  <rect x="260" y="100" width="780" height="110" rx="10" ry="10"
        fill="#fafafa" stroke="#bdbdbd" stroke-width="1.2" />
  <text x="280" y="120" class="small">Capa de acceso (UIs)</text>

  <!-- UIs individuales -->
  <rect x="280" y="130" width="140" height="70" rx="8" ry="8" class="box" />
  <text x="350" y="160" text-anchor="middle" class="label">Superset</text>
  <text x="350" y="178" text-anchor="middle" class="small">Dashboards BI</text>

  <rect x="440" y="130" width="140" height="70" rx="8" ry="8" class="box" />
  <text x="510" y="160" text-anchor="middle" class="label">JupyterLab</text>
  <text x="510" y="178" text-anchor="middle" class="small">Notebooks</text>

  <rect x="600" y="130" width="140" height="70" rx="8" ry="8" class="box" />
  <text x="670" y="160" text-anchor="middle" class="label">Airflow Web</text>
  <text x="670" y="178" text-anchor="middle" class="small">Orquestación</text>

  <rect x="760" y="130" width="140" height="70" rx="8" ry="8" class="box" />
  <text x="830" y="160" text-anchor="middle" class="label">n8n</text>
  <text x="830" y="178" text-anchor="middle" class="small">Automatización / OAuth</text>

  <!-- Adminer -->
  <rect x="920" y="280" width="140" height="60" rx="8" ry="8" class="box" />
  <text x="990" y="310" text-anchor="middle" class="label">Adminer</text>
  <text x="990" y="328" text-anchor="middle" class="small">Gestión MariaDB</text>

  <!-- Capa de orquestación -->
  <rect x="260" y="250" width="640" height="110" rx="10" ry="10"
        fill="#f1f8e9" stroke="#c5e1a5" stroke-width="1.2" />
  <text x="280" y="270" class="small">Capa de orquestación / procesado</text>

  <!-- Airflow + Flower -->
  <rect x="280" y="280" width="160" height="70" rx="8" ry="8" class="box-orch" />
  <text x="360" y="305" text-anchor="middle" class="label">Airflow</text>
  <text x="360" y="323" text-anchor="middle" class="small">DAGs / Scheduler</text>

  <rect x="460" y="280" width="140" height="70" rx="8" ry="8" class="box-orch" />
  <text x="530" y="305" text-anchor="middle" class="label">Flower</text>
  <text x="530" y="323" text-anchor="middle" class="small">Monitoreo Celery</text>

  <!-- Spark -->
  <rect x="620" y="270" width="260" height="100" rx="10" ry="10" class="box-proc" />
  <text x="750" y="292" text-anchor="middle" class="label">Spark Cluster</text>
  <text x="750" y="309" text-anchor="middle" class="small">Master + Workers + History</text>

  <rect x="640" y="310" width="90" height="45" rx="6" ry="6" class="box" />
  <text x="685" y="336" text-anchor="middle" class="small">Master</text>

  <rect x="742" y="310" width="90" height="45" rx="6" ry="6" class="box" />
  <text x="787" y="336" text-anchor="middle" class="small">Worker(s)</text>

  <rect x="844" y="310" width="90" height="45" rx="6" ry="6" class="box" />
  <text x="889" y="336" text-anchor="middle" class="small">History</text>

  <!-- Capa de datos -->
  <rect x="260" y="400" width="640" height="170" rx="10" ry="10"
        fill="#fffde7" stroke="#ffe082" stroke-width="1.2" />
  <text x="280" y="420" class="small">Capa de datos</text>

  <!-- MariaDB -->
  <rect x="280" y="430" width="200" height="80" rx="12" ry="12" class="box-db" />
  <text x="380" y="460" text-anchor="middle" class="label">MariaDB</text>
  <text x="380" y="480" text-anchor="middle" class="small">Base transaccional</text>

  <!-- MinIO -->
  <rect x="520" y="430" width="170" height="80" rx="12" ry="12" class="box-db" />
  <text x="605" y="460" text-anchor="middle" class="label">MinIO</text>
  <text x="605" y="480" text-anchor="middle" class="small">Datalake S3</text>

  <!-- Redis -->
  <rect x="720" y="430" width="160" height="80" rx="12" ry="12" class="box-db" />
  <text x="800" y="460" text-anchor="middle" class="label">Redis</text>
  <text x="800" y="480" text-anchor="middle" class="small">Broker Celery</text>

  <!-- Volúmenes compartidos -->
  <rect x="280" y="525" width="600" height="30" rx="8" ry="8"
        fill="#eeeeee" stroke="#9e9e9e" stroke-width="1" />
  <text x="580" y="545" text-anchor="middle" class="small">
    volumenes/shared (DAGs, scripts, spark-events, datos compartidos)
  </text>

  <!-- Flechas desde usuario a UIs -->
  <line x1="180" y1="150" x2="260" y2="165" class="arrow" />
  <!-- Usuario a Adminer -->
  <line x1="180" y1="150" x2="920" y2="300" class="arrow" />

  <!-- UIs a servicios -->
  <!-- Superset -> MariaDB / MinIO -->
  <line x1="350" y1="200" x2="380" y2="430" class="arrow" />
  <line x1="350" y1="200" x2="605" y2="430" class="arrow" />

  <!-- JupyterLab -> Spark / MariaDB / MinIO -->
  <line x1="510" y1="200" x2="685" y2="310" class="arrow" />
  <line x1="510" y1="200" x2="380" y2="430" class="arrow" />
  <line x1="510" y1="200" x2="605" y2="430" class="arrow" />

  <!-- Airflow Web -> Airflow core -->
  <line x1="670" y1="200" x2="360" y2="280" class="arrow" />

  <!-- n8n -> MariaDB / MinIO / otros -->
  <line x1="830" y1="200" x2="800" y2="430" class="arrow" />
  <line x1="830" y1="200" x2="605" y2="430" class="arrow" />
  <line x1="830" y1="200" x2="380" y2="430" class="arrow" />

  <!-- Airflow -> Spark / DB / MinIO / Redis -->
  <line x1="360" y1="350" x2="685" y2="310" class="arrow" />
  <line x1="360" y1="350" x2="380" y2="430" class="arrow" />
  <line x1="360" y1="350" x2="605" y2="430" class="arrow" />
  <line x1="440" y1="315" x2="800" y2="430" class="arrow" />

  <!-- Spark -> MinIO / MariaDB -->
  <line x1="787" y1="355" x2="605" y2="430" class="arrow" />
  <line x1="787" y1="355" x2="380" y2="430" class="arrow" />

  <!-- Adminer -> MariaDB -->
  <line x1="920" y1="310" x2="480" y2="450" class="arrow" />

</svg>
